clear;

load ../SetupPosition/MyMesh.mat;

[Kg,Mesh]=GlobalTimoLattice3D(Mesh,Sc);

%% Check Dependency

Dependency0=zeros(24,3);

Dependency0(:,1)=[...
    13 41 27 55 14 28 42 56  ...
    18 46 58 57 ...
    59 61 63 60 62 64  ...
    6 12 34 24 52 40  ...
    ].';

Dependency0(:,2)=[...
    1 29 16 44 2 17 30 45  ...
    15 43 2 1 ...
    4 7 10 5 8 11 ...
    3 9 31 21 49 37  ...
    ].';

Dependency0(:,3)=[...
    2.*ones(8,1); ...
    3.*ones(2,1); ...
    ones(2,1); ...
    ones(6,1); ...
    3.*ones(6,1)];
    
 [~,NS]=sort(Dependency0(:,1));
 
 Dependency=Dependency0(NS,:);
 SuperInd=true(64,1);
 IND=[1:64].';
 SuperInd(Dependency(:,1))=false;
 IND=IND(SuperInd);
 
 AType=zeros(size(Dependency0,1),3);
 for n1=1:size(Dependency0,1)
     AType(n1,Dependency(n1,3))=1;
 end
 
 [Out]=Vig3DSystemAuxectic(Mesh,Sc);   
    